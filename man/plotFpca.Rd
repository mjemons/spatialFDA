% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/funcPca.R
\name{plotFpca}
\alias{plotFpca}
\title{Plot a biplot from an fPCA analysis}
\usage{
plotFpca(dat, res, colourby = NULL, labelby = NULL)
}
\arguments{
\item{dat}{a data object for functional data analysis containing at least the
the functional}

\item{res}{the output from the fPCA calculation}

\item{colourby}{the variable by which to colour the PCA plot by}

\item{labelby}{the variable by which to label the PCA plot by}
}
\value{
a list with components of fpca.face
}
\description{
Plot a biplot from an fPCA analysis
}
\examples{
# load the pancreas dataset
library("tidyr")
library("stringr")
library("dplyr")
spe <- imcdatasets::Damond_2019_Pancreas("spe", full_dataset = FALSE)
# calculate the Gcross metric for alpha and beta cells
metric_res <- calcMetricPerFov(spe, c("alpha", "beta"),
    subsetby = "image_number", fun = "Gcross",
    marks = "cell_type", r_seq = seq(0, 50, length.out = 50),
    c("patient_stage", "patient_id"), ncores = 2
)
metric_res$ID <- paste0(
    metric_res$patient_stage, "x", metric_res$patient_id,
    "x", metric_res$image_id
)
# prepare data for FDA
dat <- prepData(metric_res, "r", "rs")

# drop rows with NA
dat <- dat |> drop_na()
# create meta info of the IDs
split_data <- str_split(dat$ID, "x")
dat$condition <- factor(sapply(split_data, `[`, 1))
dat$patient_id <- factor(sapply(split_data, `[`, 2))
dat$image_id <- factor(sapply(split_data, `[`, 3))
# calculate fPCA
mdl <- functionalPCA(dat = dat, r = metric_res$r |> unique(), knots = 30, pve = 0.99)
p <- plotFpca(dat = dat, res = mdl, colourby = 'condition', labelby = 'patient_id')
print(p)
}
